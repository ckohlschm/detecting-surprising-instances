{% extends "detection/method_selection.html" %}
{% load static %}

{% block title %} Select Parameters {% endblock %} 

{% block method_parameters %}
<!-- Form -->
<form method="POST">
    {% csrf_token %}
    <div>
        <div class="mb-4">
            <label class="my-1 me-2" for="situation_type">Type of situation:</label>
            <select class="form-select" id="situation_type" name="situation_type"  aria-label="Type of situation">
                <option name="case" value="case" {% if situation_type == 'case' %} selected {% endif %}>Case situation</option>
                <option name="event" value="event" {% if situation_type == 'event' %} selected {% endif %}>Event situation</option>
            </select>
        </div>
        <div class="mb-4" id="div_event_situation_activity">
            <label class="my-1 me-2" for="selected_activity">Activity:</label>
            <select class="form-select" id="selected_activity" name="selected_activity"  aria-label="Activity">
                {% for activity_name in activity_names %}
                <option name="{{activity_name}}" value="{{activity_name}}" {% if activity_name == selected_activity %} selected {% endif %}>{{activity_name}}</option>
                {% endfor %} 
            </select>
        </div>
    </div>
    <div>
        <div class="fs-5 fw-normal mb-2">Vicinity Detection</div>
        <div class="mb-4">
            <label class="my-1 me-2" for="distance">Distance function:</label>
            <select class="form-select" id="similarity_graph_distance_function" name="similarity_graph_distance_function"  aria-label="Distance function">
                <option value="similarity_graph_distance_function_levenshtein" {% if similarity_graph_distance_function == 'similarity_graph_distance_function_levenshtein' %} selected {% endif %}>Levenshtein distance</option>
                <option value="similarity_graph_distance_function_euclidean" {% if similarity_graph_distance_function == 'similarity_graph_distance_function_euclidean' %} selected {% endif %}>Euclidean distance</option>
            </select>
        </div>
        <div class="mb-4">
            <label class="my-1 me-2" for="similarity_graph_distance_max">Maximum distance:</label>
            <input type="number" step="0.01" id="similarity_graph_distance_max" name="similarity_graph_distance_max" value="{{ similarity_graph_distance_max }}">
        </div>
        <div class="mb-4" id="div_case_features">
            <label class="my-1 me-2" for="descriptive_attributes">Descriptive Features:</label>
            <select class="form-select" id="descriptive_attributes" name="descriptive_attributes" style="resize: vertical" aria-label="Descriptive attributes" multiple>
                {% for feature in feature_names %}
                <option name="{{ feature }}" value="{{ feature }}" {% if feature in selected_feature_names %} selected {% endif %}>{{ feature }}</option>
                {% endfor %} 
            </select>
        </div>
        <div class="mb-4" id="div_event_features">
            <label class="my-1 me-2" for="event_features">Descriptive Features:</label>
            <select class="form-select" id="event_features" name="event_features" style="resize: vertical" aria-label="Descriptive attributes" multiple>
                {% for feature in event_attribute_names %}
                <option name="{{ feature }}" value="{{ feature }}">{{ feature }}</option>
                {% endfor %} 
            </select>
        </div>
    </div>    
    <div>
        <div class="fs-5 fw-normal mb-2">Surprising Instance Detection</div>
        <div class="mb-4" id="case_level_target_features">
            <label class="my-1 me-2" for="target_attribute">Target Feature name:</label>
            <div class="mb-4" id="div_event_target_feature">
                <select class="form-select" id="target_attribute_event" name="target_attribute_event"  aria-label="Target attribute">
                    <option name="elapsed time" value="elapsed time" {% if 'elapsed_time' == target_attribute %} selected {% endif %}>Elapsed Time</option> 
                    <option name="next activity" value="next activity" {% if 'next_activity' == target_attribute %} selected {% endif %}>Next Activity</option>
                    <option name="previous activity" value="previous activity" {% if 'previous_activity' == target_attribute %} selected {% endif %}>Previous Activity</option> 
                </select>
            </div>
            <div class="mb-4" id="div_case_target_feature">
                <select class="form-select" id="target_attribute_case" name="target_attribute_case"  aria-label="Target attribute">
                    <option name="@@caseDuration" value="@@caseDuration" {% if '@@caseDuration' == target_attribute %} selected {% endif %}>Case Duration</option> 
                    <option name="@@delay" value="@@delay" {% if '@@delay' == target_attribute %} selected {% endif %}>Delay</option>
                </select>
            </div>
        </div>
        <div id="div_detector_function">
            <div class="mb-4">
                <label class="my-1 me-2" for="detector_function">Detector function:</label>
                <select class="form-select" id="detector_function" name="detector_function"  aria-label="Detector function">
                    <option name="boxplot" value="boxplot" {% if detector_function == 'boxplot' %} selected {% endif %}>Boxplot</option>
                    <option name="threshold" value="threshold" {% if detector_function == 'threshold' %} selected {% endif %}>Threshold</option>
                </select>
            </div>
            <div class="mb-4" id="div_numerical_threshold">
                <label class="my-1 me-2" for="target_attribute_threshold">Numerical Threshold:</label>
                <input type="range" id="target_attribute_threshold" name="target_attribute_threshold" min="0" max="{{max_case_duration_seconds}}" value="{{ target_attribute_threshold }}">
                <label id="caseDuration">2 days</label>
            </div>
        </div>
    </div>
    <div class="d-flex">
        <button type="submit" id="submit_parameters_similarity_graph" name="submit_parameters_similarity_graph" class="btn btn-primary">Detect Surprising Instances</button>
    </div>
</form>
<!-- End of Form -->
{% endblock method_parameters %}

