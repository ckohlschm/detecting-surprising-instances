{% extends 'layouts/base-fullscreen.html' %}

{% load bootstrap5 %}

{% block title %}
    Detecting Surprising Instances in a Process
{% endblock %}

{% block stylesheets %}{% endblock stylesheets %}

{% block content %}
    <!-- data-background-lg="/static/assets/img/illustrations/signin.svg" -->
    <main>
        <section class="vh-lg-100 mt-5 mt-lg-0 bg-soft d-flex align-items-center">
            <div class="container">
                <p class="text-center">
                    Detecting Surprising Instances in a Process
                </p>
                <div class="row justify-content-center form-bg-image">
                    <div class="col-12 d-flex align-items-center justify-content-center">
                        <div class="bg-white shadow border-0 rounded border-light p-4 p-lg-5 w-100 fmxw-500">
                            <form method="POST">
                                {% csrf_token %}
                                <div>
                                    <div class="fs-5 fw-normal mb-2">Target Feature</div>
                                    <div class="mb-4">
                                        <label class="my-1 me-2" for="situation_type">Type of situation:</label>
                                        <select class="form-select" id="situation_type" name="situation_type"  aria-label="Type of situation">
                                            <option name="case" value="case" {% if situation_type == 'case' %} selected {% endif %}>Case situation</option>
                                            <option name="event" value="event" {% if situation_type == 'event' %} selected {% endif %}>Event situation</option>
                                        </select>
                                    </div>
                                    <div class="mb-4" id="div_situation_activity">
                                        <label class="my-1 me-2" for="selected_activity">Activity:</label>
                                        <select class="form-select" id="selected_activity" name="selected_activity"  aria-label="Activity">
                                            {% for activity_name in activity_names %}
                                            <option name="{{activity_name}}" value="{{activity_name}}" {% if activity_name == selected_activity %} selected {% endif %}>{{activity_name}}</option>
                                            {% endfor %} 
                                        </select>
                                    </div>
                                    <div class="mb-4" id="event_level_target_features">
                                        <label class="my-1 me-2" for="target_attribute">Event Target Feature name:</label>
                                        <select class="form-select" id="target_attribute_event" name="target_attribute_event"  aria-label="Target attribute">
                                            <option name="elapsed_time" value="elapsed_time" {% if 'elapsed_time' == target_attribute %} selected {% endif %}>Elapsed Time</option> 
                                            <option name="next_activity" value="next_activity" {% if 'next_activity' == target_attribute %} selected {% endif %}>Next Activity</option>
                                            <option name="previous_activity" value="previous_activity" {% if 'previous_activity' == target_attribute %} selected {% endif %}>Previous Activity</option> 
                                        </select>
                                    </div>
                                    <div class="mb-4" id="case_level_target_features">
                                        <label class="my-1 me-2" for="target_attribute">Case Target Feature name:</label>
                                        <select class="form-select" id="target_attribute_case" name="target_attribute_case"  aria-label="Target attribute">
                                            <option name="@@caseDuration" value="@@caseDuration" {% if '@@caseDuration' == target_attribute %} selected {% endif %}>Case Duration</option> 
                                            <option name="case_delay" value="case_delay" {% if 'case_delay' == target_attribute %} selected {% endif %}>Delay</option> 
                                        </select>
                                    </div>
                                    <!-- <div class="mb-4">
                                        <label class="my-1 me-2" for="descriptive_attributes_event">Descriptive Event Features:</label>
                                        <select class="form-select" id="descriptive_attributes_event" name="descriptive_attributes_event"  aria-label="Event attributes" multiple>
                                            {% for feature in event_attributes %}
                                            <option name="{{ feature }}" value="{{ feature }}" {% if feature in selected_features %} selected {% endif %}>{{ feature }}</option>
                                            {% endfor %} 
                                        </select>
                                    </div>
                                    <div class="mb-4">
                                        <label class="my-1 me-2" for="descriptive_attributes_event">Descriptive Case Features:</label>
                                        <select class="form-select" id="descriptive_attributes_event" name="descriptive_attributes_event"  aria-label="Event attributes" multiple>
                                            {% for feature in event_attributes %}
                                            <option name="{{ feature }}" value="{{ feature }}" {% if feature in selected_features %} selected {% endif %}>{{ feature }}</option>
                                            {% endfor %} 
                                        </select>
                                    </div>
                                    <div class="mb-4">
                                        <label class="my-1 me-2" for="descriptive_activities">Interesting activities:</label>
                                        <select class="form-select" id="descriptive_activities" name="descriptive_activities"  aria-label="Event activities" multiple>
                                            {% for feature in activity_names %}
                                            <option name="{{ feature }}" value="{{ feature }}" {% if feature in selected_features %} selected {% endif %}>{{ feature }}</option>
                                            {% endfor %} 
                                        </select>
                                    </div> -->
                                    <div class="d-flex">
                                        <button type="submit" id="submit_selected_situation_parameters" name="submit_selected_situation_parameters" class="btn btn-primary">Select Situation features</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

{% endblock content %}
<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
<script>
let selectedSituationType = document.getElementById('situation_type');
let situationActivityBlock = document.getElementById('selected_activity');
let situationTargetFeatureCase = document.getElementById('target_attribute_case');
let situationTargetFeatureEvent = document.getElementById('target_attribute_event');

// use 'change' instead to see the difference in response
selectedSituationType.addEventListener('change', function () {
    var selectedSituationTypeValue = selectedSituationType.value;
    console.log(selectedSituationTypeValue)
    if (selectedSituationTypeValue === "case") {
        situationActivityBlock.disabled = true;
        situationTargetFeatureCase.disabled = false;
        situationTargetFeatureEvent.disabled = true;
    }
    else {
        situationActivityBlock.disabled = false;
        situationTargetFeatureCase.disabled = true;
        situationTargetFeatureEvent.disabled = false;
    }
}, false);

var selectedSituationTypeValue = selectedSituationType.value;
if (selectedSituationTypeValue === "case") {
    situationActivityBlock.disabled = true;
    situationTargetFeatureEvent.disabled = true;
}
</script>
{% endblock javascripts %}